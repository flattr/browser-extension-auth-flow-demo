# Client demo
WIP: Include info about how it works here.

## Checking if the visitor is a paying Flattr user

The visiting extension will expose an api endpoint if there is an active user, calling it will instantly return the below specified [payload](#payload) for user validation.
```js
FlattrExt.isPayingUser(): payload
```

### Payload structure<a name="payload"></a>

In its compact form the payload will consist of two base64 encoded parts separated by a dot ( . ), which are:

* data
* signature

Therefore, a payload will look like the following.

`xxxx.yyyyyyyyyyyyyyyy`

Let's break down the different parts.

**Data**

The first part is the actual data about the user, in the form of a json object. There are currently
two properties: paying and iat.

Example JSON data could be:

	{
	  "paying": true,
	  "iat": 1603885771
	}

The JSON object is then base64 encoded to form the first part of the payload.

**Signature**

The second and last part of the payload is the data signature. The signature is used to verify that the message wasn't changed along the way and to verify that the payload is from Flattr.

The signature is generated by cryptographically signing the (unencoded) data part of the payload and then base64 encoding the result. The algorithm used is currently RSA with SHA-256.


**Verifying the payload signature**

[Example page](demo/index.html)
[Example JS](demo/main.js)
